(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{1109:(e,r,t)=>{"use strict";function a(e){let r=(e||"").toLowerCase();return"admin"===r||"manager"===r||"user"===r||"guest"===r?r:"guest"}function n(e,r){return"public"===r||r.includes(e)}t.d(r,{G:()=>a,z:()=>n})},17611:(e,r,t)=>{"use strict";t.d(r,{$c:()=>x,Iy:()=>p,UC:()=>g});var a=t(57383);let n="access_token",s="refresh_token",o="user_id",i="user_role";t(8777);var l=t(49641).Buffer;let d=window.crypto.subtle;async function c(){console.log(1);try{let e=new TextEncoder().encode("d376510d93962d354924c88547463f2722b512c5b36449195b2c93883398f625"),r=await d.digest("SHA-256",e);return d.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"])}catch(e){console.warn(1,e.message)}}async function u(e){let r=await c(),t=crypto.getRandomValues(new Uint8Array(12)),a=new TextEncoder,n=await crypto.subtle.encrypt({name:"AES-GCM",iv:t},r,a.encode(e)),s=new Uint8Array(t.byteLength+n.byteLength);return s.set(t,0),s.set(new Uint8Array(n),t.byteLength),(void 0!==l?l.from(s).toString("base64"):btoa(String.fromCharCode(...s))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}async function f(e){if(!e)return null;try{let r=await c(),t=function(e){let r=e.replace(/-/g,"+").replace(/_/g,"/")+"===".slice((e.length+3)%4),t=void 0!==l?l.from(r,"base64"):atob(r);if("string"==typeof t){let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}return new Uint8Array(t)}(e),a=t.slice(0,12),n=t.slice(12),s=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},r,n);return new TextDecoder().decode(s)}catch(e){return console.warn("Failed to decrypt cookie value",e),null}}var m=t(1109);async function p(){let e=a.A.get(n)||null,r=a.A.get(s)||null,t=a.A.get(o)||null,l=a.A.get(i)||null,d=await f(t),c=await f(l);return{accessToken:await f(e),refreshToken:await f(r),userId:d?parseInt(d,10):null,role:(0,m.G)(c)}}async function g(e){let{accessToken:r,refreshToken:t,userId:l,role:d}=e,c=await u(r),f=await u(t),m=await u(l.toString());if(a.A.set(n,c),a.A.set(s,f),a.A.set(o,m),d){let e=await u(d);a.A.set(i,e)}}async function x(){a.A.remove(n),a.A.remove(s),a.A.remove(o),a.A.remove(i)}},24536:(e,r,t)=>{Promise.resolve().then(t.bind(t,86039))},30070:(e,r,t)=>{"use strict";t.d(r,{C5:()=>h,MJ:()=>x,eI:()=>p,lR:()=>g,lV:()=>d,zB:()=>u});var a=t(95155),n=t(12115),s=t(99708),o=t(62177),i=t(34449),l=t(82714);let d=o.Op,c=n.createContext({}),u=e=>{let{...r}=e;return(0,a.jsx)(c.Provider,{value:{name:r.name},children:(0,a.jsx)(o.xI,{...r})})},f=()=>{let e=n.useContext(c),r=n.useContext(m),{getFieldState:t,formState:a}=(0,o.xW)(),s=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...s}},m=n.createContext({}),p=n.forwardRef((e,r)=>{let{className:t,...s}=e,o=n.useId();return(0,a.jsx)(m.Provider,{value:{id:o},children:(0,a.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...s})})});p.displayName="FormItem";let g=n.forwardRef((e,r)=>{let{className:t,...n}=e,{error:s,formItemId:o}=f();return(0,a.jsx)(l.J,{ref:r,className:(0,i.cn)(s&&"text-destructive",t),htmlFor:o,...n})});g.displayName="FormLabel";let x=n.forwardRef((e,r)=>{let{...t}=e,{error:n,formItemId:o,formDescriptionId:i,formMessageId:l}=f();return(0,a.jsx)(s.DX,{ref:r,id:o,"aria-describedby":n?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!n,...t})});x.displayName="FormControl",n.forwardRef((e,r)=>{let{className:t,...n}=e,{formDescriptionId:s}=f();return(0,a.jsx)("p",{ref:r,id:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...n})}).displayName="FormDescription";let h=n.forwardRef((e,r)=>{let{className:t,children:n,...s}=e,{error:o,formMessageId:l}=f(),d=o?String(null==o?void 0:o.message):n;return d?(0,a.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",t),...s,children:d}):null});h.displayName="FormMessage"},34449:(e,r,t)=>{"use strict";t.d(r,{cn:()=>s});var a=t(52596),n=t(39688);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,a.$)(r))}},81775:(e,r,t)=>{"use strict";t.d(r,{n:()=>a});let a=(0,t(65453).v)(e=>({role:"guest",isLoaded:!1,setRole:r=>e({role:r}),hydrateFromServer:async()=>{e({role:"guest",isLoaded:!0})}}))},82714:(e,r,t)=>{"use strict";t.d(r,{J:()=>d});var a=t(95155),n=t(12115),s=t(40968),o=t(74466),i=t(34449);let l=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)(s.b,{ref:r,className:(0,i.cn)(l(),t),...n})});d.displayName=s.b.displayName},86039:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>y});var a=t(95155),n=t(35695),s=t(62177),o=t(90221),i=t(56671),l=t(88482),d=t(89852),c=t(97168),u=t(30070),f=t(17611),m=t(81775),p=t(70927);let g=p.Ik({email:p.Yj().min(1,"Email is required").email("Please enter a valid email"),password:p.Yj().min(6,"Password must be at least 6 characters")});async function x(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=await fetch("http://carehomes-dev.eba-8v8h9sbp.us-east-1.elasticbeanstalk.com/api"+e,{...r,headers:{"Content-Type":"application/json",Accept:"application/json","X-Tenant":"first",...r.headers||{}},cache:"no-store"});if(!t.ok){let e=await t.json();throw Error("API error: ".concat(e.message))}return t.json()}let h=async e=>await x("/authorization/login",{method:"POST",body:JSON.stringify(e)});function y(){let e=(0,n.useRouter)(),r=(0,m.n)(e=>e.setRole),t=(0,s.mN)({resolver:(0,o.u)(g),defaultValues:{email:"",password:""},mode:"onSubmit"});async function p(t){try{var a;let n=await h(t);if(!("data"in n)&&(null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.token)){i.oR.error("Login failed");return}let s=null==n?void 0:n.data;if(!s){i.oR.error("Login failed");return}await (0,f.UC)({accessToken:s.plain_text_token,refreshToken:s.plain_text_token,userId:s.tokenable_id,role:"admin"}),r("admin"),e.push("/settings"),e.refresh()}catch(r){let e=r instanceof Error?r.message:"Login failed";i.oR.error(e)}}let{isSubmitting:x}=t.formState;return(0,a.jsx)("div",{className:"min-h-[100dvh] flex items-center justify-center bg-background p-4",children:(0,a.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Sign in"}),(0,a.jsx)(l.BT,{children:"Access your care management dashboard"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)(u.lV,{...t,children:(0,a.jsxs)("form",{onSubmit:t.handleSubmit(p),className:"space-y-4",children:[(0,a.jsx)(u.zB,{control:t.control,name:"email",render:e=>{let{field:r}=e;return(0,a.jsxs)(u.eI,{children:[(0,a.jsx)(u.lR,{children:"Email"}),(0,a.jsx)(u.MJ,{children:(0,a.jsx)(d.p,{type:"email",autoComplete:"email",placeholder:"you@example.com",...r})}),(0,a.jsx)(u.C5,{})]})}}),(0,a.jsx)(u.zB,{control:t.control,name:"password",render:e=>{let{field:r}=e;return(0,a.jsxs)(u.eI,{children:[(0,a.jsx)(u.lR,{children:"Password"}),(0,a.jsx)(u.MJ,{children:(0,a.jsx)(d.p,{type:"password",autoComplete:"current-password",...r})}),(0,a.jsx)(u.C5,{})]})}}),(0,a.jsx)(c.$,{type:"submit",className:"w-full",disabled:x,children:x?"Signing inâ€¦":"Sign in"})]})})})]})})}},88482:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>i});var a=t(95155),n=t(12115),s=t(34449);let o=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});o.displayName="Card";let i=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...n})});i.displayName="CardHeader";let l=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...n})});c.displayName="CardContent",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},89852:(e,r,t)=>{"use strict";t.d(r,{p:()=>o});var a=t(95155),n=t(12115),s=t(34449);let o=n.forwardRef((e,r)=>{let{className:t,type:n,...o}=e;return(0,a.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...o})});o.displayName="Input"},97168:(e,r,t)=>{"use strict";t.d(r,{$:()=>d,r:()=>l});var a=t(95155),n=t(12115),s=t(99708),o=t(74466),i=t(34449);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,r)=>{let{className:t,variant:n,size:o,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:t})),ref:r,...c})});d.displayName="Button"}},e=>{var r=r=>e(e.s=r);e.O(0,[268,389,571,385,683,671,441,684,358],()=>r(24536)),_N_E=e.O()}]);